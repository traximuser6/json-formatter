<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>JSON Cleaner & Formatter — Super Recover</title>

  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Toastr for notifications -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css"/>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>

  <link rel="stylesheet" href="style.css">

</head>
<body class="min-h-screen flex flex-col">

<header class="bg-gradient-to-r from-sky-600 to-indigo-600 text-white py-6 shadow">
  <div class="container mx-auto px-4">
    <h1 class="text-2xl md:text-3xl font-semibold text-center">JSON Cleaner & Formatter — Super Recover</h1>
    <p class="text-center muted small mt-1" style="color: white">Best-effort cleaning for badly formatted, escaped, or double-encoded JSON. Shows console details & notifications.</p>
  </div>
</header>

<main class="container mx-auto px-4 py-8 flex-1">
  <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">

    <div class="panel">
      <div class="flex items-start justify-between">
        <div>
          <label for="uncleanJson" class="font-medium">Unclean JSON Input</label>
          <p class="muted small mt-1">Paste your raw / broken JSON here. Example: double-encoded strings, stray slashes like <span class="code-note">\/</span>, trailing commas, etc.</p>
        </div>
        <div class="text-right flex  single-line">
          <button id="sampleBtn" class="px-3 py-1 bg-white border rounded text-sm mr-2">Insert sample</button>
          <button id="clearInput" class="px-3 py-1 bg-white border rounded text-sm">Clear</button>
        </div>
      </div>

      <textarea id="uncleanJson" class="editor mt-3 w-full font-mono text-sm p-4 border rounded" placeholder='Paste raw JSON here...'></textarea>

      <div class="mt-3 flex gap-2 single-line">
        <button id="parseButton" class="px-4 py-2 bg-sky-600 hover:bg-sky-700 text-white rounded shadow">Clean & Format</button>
        <button id="beautifyButton" class="px-4 py-2 bg-white border rounded">Try Beautify</button>
        <button id="minifyButton" class="px-4 py-2 bg-white border rounded">Minify</button>
        <button id="copyInput" class="px-4 py-2 bg-white border rounded">Copy Input</button>
      </div>
    </div>

    <div class="panel">
      <div class="flex items-start justify-between">
        <div>
          <label for="cleanJson" class="font-medium">Cleaned & Formatted JSON Output</label>
          <p class="muted small mt-1">Result will appear here (read-only). You can copy or download it.</p>
        </div>
        <div class="text-right">
          <button id="copyOutput" class="px-3 py-1 bg-white border rounded text-sm mr-2">Copy</button>
          <button id="downloadOutput" class="px-3 py-1 bg-white border rounded text-sm">Download</button>
        </div>
      </div>

      <textarea id="cleanJson" class="editor mt-3 w-full font-mono text-sm p-4 bg-gray-50 border rounded" readonly></textarea>

      <div class="mt-3">
        <div class="muted small">Diagnostics</div>
        <pre id="diagnostics" class="code-note mt-2 p-3 bg-gray-50 rounded h-28 overflow-auto border"></pre>
      </div>
    </div>

  </div>

  <div class="mt-6 grid grid-cols-1 md:grid-cols-3 gap-4">
    <div class="panel small">
      <div class="font-medium">How it tries to repair</div>
      <ul class="mt-2 list-disc ml-5 muted small">
        <li>Attempt raw <code>JSON.parse</code> first</li>
        <li>Remove unescaped control chars and stray invisible bytes</li>
        <li>Fix trailing commas and collapse repeated backslashes</li>
        <li>Convert sensible single quoted JSON to double quotes</li>
        <li>Quote unquoted keys using a conservative heuristic</li>
        <li>Extract first JSON-like substring if the whole input contains noise</li>
        <li>Recursively parse nested stringified JSON fields</li>
        <li>Handle double-escaping and stray slashes</li>
      </ul>
    </div>

    <div class="panel small">
      <div class="font-medium">Notes & limits</div>
      <p class="muted mt-2">This is a best-effort fixer. It tries many heuristics — if your JSON is extremely ambiguous or the repairs would risk changing intended text content, manual fixing may still be needed. All repair steps are logged to the diagnostics area and browser console. Max input: 5MB.</p>
    </div>

    <div class="panel small" style="overflow: scroll">
      <div class="font-medium">Example</div>
      <p class="muted mt-2 code-note">["{\"NMLS\":2046912,\"Role\":2,\"Email\":\"zgannam@westcapitallending.com\",\"Phone\":\"(949) 404-5573\",\"UserId\":1636,..."]</p>
    </div>
  </div>

  <footer class="mt-6 text-center muted">
    &copy; <span id="year"></span> JSON Formatter Tool — Super Recover
  </footer>
</main>

<script src="script.js"></script>

</body>
</html>